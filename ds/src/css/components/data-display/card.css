/* ============================================================
   CARD COMPONENT
   Token-driven, system-aligned card styles and variants
   ============================================================ */

/* ------------------------------------------------------------
   BASE CARD
   ------------------------------------------------------------ */
.card {
  position: relative;
  display: flex;
  flex-direction: column;

  background-color: var(--color-bg-surface);
  border: var(--border-width-thin) solid var(--color-border);
  border-radius: var(--radius-xs);
  overflow: hidden;

  color: var(--color-text-body);
  transition:
    background-color var(--ms-base) var(--ease-standard),
    border-color var(--ms-base) var(--ease-standard),
    box-shadow var(--ms-base) var(--ease-standard),
    transform var(--ms-base) var(--ease-standard);
}

/* Accessibility focus ring */
.card:focus-within {
  outline: none;
  box-shadow: 0 0 0 var(--focus-ring-width) color-mix(in srgb, var(--color-accent) 12%, transparent);
}

/* ------------------------------------------------------------
   INTERACTIVE CARD
   ------------------------------------------------------------ */
.card-interactive {
  cursor: pointer;
}

.card-interactive:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-md);
  border-color: var(--color-gray-300);
}

/* Disable hover if internal interactive elements exist */
.card:has(button):hover,
.card:has(a:not(.card-link-overlay)):hover {
  transform: none;
  box-shadow: none;
  cursor: default;
}

/* ------------------------------------------------------------
   BACKGROUND / MEDIA
   ------------------------------------------------------------ */
.card-background {
  border: none;
  min-height: 240px;
  position: relative;
}

.card-media,
.card__media {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  z-index: var(--z-stack-1);
}

.card-overlay {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.3);
  z-index: var(--z-stack-2);
}

.card-background .card-header,
.card-background .card-body,
.card-background .card-footer {
  position: relative;
  z-index: var(--z-stack-3);
  color: var(--color-white);
}

/* Image header variant */
.card-image-header {
  display: flex;
  flex-direction: column;
}

.card-image-header .card-media {
  width: 100%;
  height: var(--card-image-header-height, 180px);
  object-fit: cover;
  flex-shrink: 0;
}

.card-image-header .card-body {
  padding-top: var(--space-m);
}

/* ------------------------------------------------------------
   LAYOUT VARIANTS
   ------------------------------------------------------------ */
.card-horizontal {
  flex-direction: row;
}

.card-horizontal .card-image,
.card-horizontal .card-media-container {
  width: 40%;
  flex-shrink: 0;
}

@media (max-width: var(--breakpoint-s)) {
  .card-horizontal {
    flex-direction: column;
  }

  .card-horizontal .card-image {
    width: 100%;
  }
}

/* ------------------------------------------------------------
   INTERNAL SECTIONS
   ------------------------------------------------------------ */
.card-header,
.card-body,
.card-footer {
  padding: var(--space-l);
}

.card-header {
  border-bottom: var(--border-width-thin) solid var(--color-gray-100);
}

.card-footer {
  margin-top: auto;
  padding-top: var(--space-m);
  border-top: var(--border-width-thin) solid var(--color-gray-100);
}

/* Compact sections */
.card-compact .card-header,
.card-compact .card-body,
.card-compact .card-footer {
  padding: var(--space-m);
}

/* ------------------------------------------------------------
   GRID INSIDE CARD
   ------------------------------------------------------------ */
.card-grid {
  display: grid;
  gap: var(--space-xxs);
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
}

.card-grid-inner {
  display: grid;
  gap: var(--space-m);
}

.card-grid-inner-2 { grid-template-columns: repeat(2, 1fr); }
.card-grid-inner-3 { grid-template-columns: repeat(3, 1fr); }
.card-grid-inner-4 { grid-template-columns: repeat(4, 1fr); }

@media (max-width: var(--breakpoint-s)) {
  .card-grid-inner-3,
  .card-grid-inner-4 {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* ------------------------------------------------------------
   INSET SHADOW
   ------------------------------------------------------------ */
.card-inset {
  box-shadow:
    inset 0 0 0 1px var(--color-border),
    inset 0 2px 6px rgba(0, 0, 0, 0.08);
}

.card-inset:hover {
  box-shadow:
    inset 0 0 0 1px var(--color-border),
    inset 0 3px 10px rgba(0, 0, 0, 0.12);
}

/* ------------------------------------------------------------
   SELECTABLE / ACTIVE STATES
   ------------------------------------------------------------ */
.card-selectable {
  cursor: pointer;
  transition:
    background-color var(--ms-base) var(--ease-standard),
    border-color var(--ms-base) var(--ease-standard),
    box-shadow var(--ms-base) var(--ease-standard);
}

.card-selectable:hover {
  border-color: var(--color-accent);
}

.card-selected {
  border-color: var(--color-accent);
  background-color: color-mix(in srgb, var(--color-accent) 10%, transparent);
  box-shadow: var(--shadow-md);
}

.card-selected .card-header,
.card-selected .card-body,
.card-selected .card-footer {
  color: var(--color-accent);
}

/* ------------------------------------------------------------
   RIBBON / BADGE
   ------------------------------------------------------------ */
.card-ribbon {
  position: relative;
}

.card-ribbon::before {
  content: attr(data-ribbon);
  position: absolute;
  top: var(--space-s);
  right: -40px;

  background-color: var(--color-accent);
  color: var(--color-white);

  padding: var(--space-xxs) var(--space-s);
  font-size: var(--fs-tiny);
  font-weight: var(--fw-bold);

  transform: rotate(45deg);
  width: 140px;
  text-align: center;

  box-shadow: var(--shadow-sm);
  pointer-events: none;
}

/* Small ribbon variant */
.card-ribbon-small::before {
  right: -28px;
  width: 110px;
  padding: var(--space-xxs) var(--space-xs);
  font-size: var(--fs-small);
}

/* ------------------------------------------------------------
   HOVER REVEAL
   ------------------------------------------------------------ */
.card-hover-reveal .card-hover-content {
  opacity: 0;
  transform: translateY(6px);
  transition:
    opacity var(--ms-base) var(--ease-standard),
    transform var(--ms-base) var(--ease-standard);
  pointer-events: none;
}

.card-hover-reveal:hover .card-hover-content {
  opacity: 1;
  transform: translateY(0);
  pointer-events: auto;
}

/* ------------------------------------------------------------
   COLLAPSIBLE SECTIONS
   ------------------------------------------------------------ */
.card-collapsible .card-collapse-body {
  max-height: 0;
  overflow: hidden;
  transition: max-height var(--ms-base) var(--ease-standard);
}

.card-collapsible.is-open .card-collapse-body {
  max-height: 1000px; /* large enough for content; can be replaced with JS-calculated value */
}

/* ------------------------------------------------------------
   FLOATING ACTION BUTTON
   ------------------------------------------------------------ */
.card-fab {
  position: absolute;
  right: var(--space-m);
  bottom: var(--space-m);
  z-index: var(--z-above);
}

.card-fab .fab {
  box-shadow: var(--shadow-sm);
  border-radius: 50%;
  width: var(--space-xxl);
  height: var(--space-xxl);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  background: var(--color-accent);
  color: var(--color-white);
  border: none;
  cursor: pointer;
}

/* ------------------------------------------------------------
   METRICS / TIMELINE HELPERS
   ------------------------------------------------------------ */
.card-metrics {
  display: flex;
  gap: var(--space-m);
  align-items: center;
  flex-wrap: wrap;
}

.card-timeline {
  display: flex;
  flex-direction: column;
  gap: var(--space-s);
}

.card-timeline .timeline-item {
  display: flex;
  gap: var(--space-s);
  align-items: flex-start;
}

.card-timeline .timeline-item::before {
  content: "";
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--color-gray-400);
  margin-top: 6px;
}

/* ------------------------------------------------------------
   THEME VARIANTS
   ------------------------------------------------------------ */
.card-accent {
  background-color: var(--color-accent);
  color: var(--color-white);
  border: none;
}

.card-black {
  background-color: var(--color-brand-black);
  color: var(--color-white);
  border: none;
}

/* ------------------------------------------------------------
   UTILITY MODIFIERS
   ------------------------------------------------------------ */
.card-compact { padding: var(--space-m); }
.card-elevated { box-shadow: var(--shadow-md); }
.card-outline { border-style: dashed; border-color: var(--color-border); }
